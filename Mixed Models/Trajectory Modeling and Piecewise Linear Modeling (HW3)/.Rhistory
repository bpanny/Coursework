knitr::opts_chunk$set(echo = TRUE)
library(lmerTest)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(lmerTest)
library(tidyverse)
cog <- read_csv("cognition.csv")
cog %>% GGally::ggpairs()
cog %>% GGally::ggpairs(columns = 2:4)
cog
cog %>% count(sexf)
cog <- read_csv("cognition.csv") %>%
mutate(sexf = factor(if_else(sexf == 1, "female", "male")))
cog %>% GGally::ggpairs(columns = 2:4)
5^2
5**2
5**3
5^3
cog <- read_csv("cognition.csv") %>%
mutate(sexf = factor(if_else(sexf == 1, "Women", "Men")),
t2 = t^2)
cog %>% GGally::ggpairs(columns = 2:5)
cog %>% count(score)
cog %>% count(t)
cog %>%
ggplot(aes(x = t, y = mean(score), color = sexf)) +
geom_line()
cog %>%
ggplot(aes(x = t, y = mean(score), color = sexf, group = t)) +
geom_line()
cog %>%
group_by(t, sexf) %>%
summarise(mean_score = mean(score))
cog %>%
group_by(t, sexf) %>%
summarise(mean_score = mean(score)) %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line()
cog %>%
group_by(t, sexf) %>%
summarise(mean_score = mean(score)) %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
cog %>%
group_by(t, sexf) %>%
summarise(mean_score = mean(score),
t2 = t2)
cog %>%
group_by(t, sexf) %>%
summarise(mean_score = mean(score))
cog %>%
group_by(t, sexf) %>%
reframe(mean_score = mean(score)) %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point() +
geom_line(aes) +
geom_point()
cog %>%
group_by(t, sexf) %>%
summarise(mean_score = mean(score)) %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point() +
geom_line(aes) +
geom_point()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ggplot(aes(x = t2, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score))
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ggplot(aes(x = t2, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ungroup() %>%
ggplot(aes(x = t2, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ungroup() %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ungroup() %>%
ggplot(aes(x = t2, y = mean_score, color = sexf)) +
geom_line() +
geom_point()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog)
int_1 %>% summary()
int_1 <- lmer(score ~ sexf * t + sexf*t2 + (1 | studyid), data = cog)
int_1 %>% summary()
int_1 <- lmer(score ~ sexf * t + sexf*t2 + (1 | studyid), data = cog)
int_1 %>% summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog)
lmer(score ~ sexf * t + sexf*t2 + (1 | studyid), data = cog) %>% summary()
int_1 %>%  summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
lmer(score ~ sexf * t + sexf*t2 + (1 | studyid), data = cog, REML = F) %>% summary()
int_1 %>%  summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_1 %>%  summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_2 <- lmer(score ~ sexf * t * t2 + (1 | studyid), data = cog, REML = F)
int_1 %>%  summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_2 <- lmer(score ~ sexf * t * t2 + (1 | studyid), data = cog, REML = F)
int_1 %>%  summary()
int_2 %>% summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_2 <- lmer(score ~ sexf * t + sex*t2 + (1 | studyid), data = cog, REML = F)
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_2 <- lmer(score ~ sexf * t + sexf*t2 + (1 | studyid), data = cog, REML = F)
int_1 %>%  summary()
int_2 %>% summary()
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ungroup() %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point() +
labs(title = "Mean Score Trajectories by Sex",
x = "Time (Years)",
y = "Mean Score",
color = "Sex")
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ungroup() %>%
ggplot(aes(x = t2, y = mean_score, color = sexf)) +
geom_line() +
geom_point() +
labs(title = "Mean Score Trajectories by Sex",
x = "Time (Years)",
y = "Mean Score",
color = "Sex")
coef_1 <- lmer(score ~ sexf * t + t2 + (1 + t | studyid), data = cog, REML = F)
coef_1 <- lmer(score ~ sexf * t + t2 + (1 + t | studyid), data = cog, REML = F)
coef_1 %>% summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_1 %>%  summary()
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = T)
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = T)
int_1 %>%  summary()
F
F
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_1 %>%  summary()
anova(int_1, coef_1)
cog %>%
group_by(t) %>%
summarise(mean = mean(score),
median = median(score),
std = sd(score),
min = min(score),
max = max(score))
cog %>%
mutate(
t_1 = factor(if_else(t == 1, TRUE, FALSE)),
t_2 = if_else(t <= 1 & t >0.3, t-0.3, 0.7),
t_2 = if_else(t <= 0.3, 0, t_2),
t_3 = if_else(t <= 1.5 & t > 1, t-1, 0.5),
t_3 = if_else(t <= 1, 0, t_3),
t_4 = if_else(t > 1.5, t-1.5, 0)
)
cog <- cog %>%
mutate(
t_1 = if_else(t == 1, 1, 0),
t_2 = if_else(t == 1, 1, 0),
t_3 = if_else(t == 1, 1, 0),
t_4 = if_else(t == 1, 1, 0),
t_5 = if_else(t == 1, 1, 0),
t_6 = if_else(t == 1, 1, 0),
t_7 = if_else(t == 1, 1, 0),
t_8 = if_else(t == 1, 1, 0),
t_9 = if_else(t == 1, 1, 0),
t_10 = if_else(t == 1, 1, 0),
)
fit_pw_rc_mle1 <- lmer(weight ~ gender + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 +
t_7 + t_8 +t_9 + t_10 + (1 + t | id), data = cog, REML=F)
cog <- cog %>%
mutate(
t_1 = if_else(t == 1, 1, 0),
t_2 = if_else(t == 1, 1, 0),
t_3 = if_else(t == 1, 1, 0),
t_4 = if_else(t == 1, 1, 0),
t_5 = if_else(t == 1, 1, 0),
t_6 = if_else(t == 1, 1, 0),
t_7 = if_else(t == 1, 1, 0),
t_8 = if_else(t == 1, 1, 0),
t_9 = if_else(t == 1, 1, 0),
t_10 = if_else(t == 1, 1, 0),
)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 +
t_7 + t_8 +t_9 + t_10 + (1 + t | id), data = cog, REML=F)
cog <- cog %>%
mutate(
t_1 = if_else(t == 1, 1, 0),
t_2 = if_else(t == 1, 1, 0),
t_3 = if_else(t == 1, 1, 0),
t_4 = if_else(t == 1, 1, 0),
t_5 = if_else(t == 1, 1, 0),
t_6 = if_else(t == 1, 1, 0),
t_7 = if_else(t == 1, 1, 0),
t_8 = if_else(t == 1, 1, 0),
t_9 = if_else(t == 1, 1, 0),
t_10 = if_else(t == 1, 1, 0),
)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 +
t_7 + t_8 +t_9 + t_10 + (1 + t | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
cog <- cog %>%
mutate(
t_1 = if_else(t == 1, 1, 0),
t_2 = if_else(t == 1, 1, 0),
t_3 = if_else(t == 1, 1, 0),
t_4 = if_else(t == 1, 1, 0),
t_5 = if_else(t == 1, 1, 0),
t_6 = if_else(t == 1, 1, 0),
t_7 = if_else(t == 1, 1, 0),
t_8 = if_else(t == 1, 1, 0),
t_9 = if_else(t == 1, 1, 0),
t_10 = if_else(t == 1, 1, 0),
)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 +
t_7 + t_8 +t_9 + t_10 + (1 | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
cog <- cog %>%
mutate(
t_1 = if_else(t == 1, 1, 0),
t_2 = if_else(t == 2, 1, 0),
t_3 = if_else(t == 3, 1, 0),
t_4 = if_else(t == 4, 1, 0),
t_5 = if_else(t == 5, 1, 0),
t_6 = if_else(t == 6, 1, 0),
t_7 = if_else(t == 7, 1, 0),
t_8 = if_else(t == 8, 1, 0),
t_9 = if_else(t == 9, 1, 0),
t_10 = if_else(t == 10, 1, 0),
)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 +
t_7 + t_8 +t_9 + t_10 + (1 | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10 + (1 | studyid), data = cog, REML=F)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10 + (1 | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
cog %>% count(t)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10 + (1 + t | studyid), data = cog, REML=F)
fit_pw_rc_mle1 <- lmer(score ~ sexf + t_1 + t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10 + (1 + t | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
fit_pw_rc_mle1 <- lmer(score ~ sexf*(t_1 + t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10) + (1 + t | studyid), data = cog, REML=F)
fit_pw_rc_mle1 <- lmer(score ~ sexf*(t_1 + t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10) + (1 + t | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
cog <- cog %>%
mutate(
t_2 = if_else(t == 2, 1, 0),
t_3 = if_else(t == 3, 1, 0),
t_4 = if_else(t == 4, 1, 0),
t_5 = if_else(t == 5, 1, 0),
t_6 = if_else(t == 6, 1, 0),
t_7 = if_else(t == 7, 1, 0),
t_8 = if_else(t == 8, 1, 0),
t_9 = if_else(t == 9, 1, 0),
t_10 = if_else(t == 10, 1, 0),
)
fit_pw_rc_mle1 <- lmer(score ~ sexf*(t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10) + (1 + t | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
anova(coef_1, fit_pw_rc_mle1)
cog %>%
pivot_longer(cols = contains('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = predict_coef, color = gender)) +
geom_smooth() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw() +
theme(legend.position = "none")
cog %>%
pivot_longer(cols = contains('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw() +
theme(legend.position = "none")
cog$predict_coef <- predict(coef_1)
cog$predict_pw <- predict(fit_pw_rc_mle1)
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw() +
theme(legend.position = "none")
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw() +
```
cog$predict_coef <- predict(coef_1)
cog$predict_pw <- predict(fit_pw_rc_mle1)
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw()
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
geom_point(aes(x = t, y = score)) +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw()
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
geom_point() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw()
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw()
cog
cog %>% glimpse
cog %>% glimpse
cog %>% pull(predict_coef)
?expand
knitr::opts_chunk$set(echo = TRUE)
library(lmerTest)
library(tidyverse)
cog <- read_csv("cognition.csv") %>%
mutate(sexf = factor(if_else(sexf == 1, "Women", "Men")),
t2 = t^2)
cog %>% GGally::ggpairs(columns = 2:5)
cog %>% count(t)
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ungroup() %>%
ggplot(aes(x = t, y = mean_score, color = sexf)) +
geom_line() +
geom_point() +
labs(title = "Mean Score Trajectories by Sex",
x = "Time (Years)",
y = "Mean Score",
color = "Sex")
cog %>%
group_by(t, t2, sexf) %>%
summarise(mean_score = mean(score)) %>%
ungroup() %>%
ggplot(aes(x = t2, y = mean_score, color = sexf)) +
geom_line() +
geom_point() +
labs(title = "Mean Score Trajectories by Sex",
x = "Time^2 (Years^2)",
y = "Mean Score",
color = "Sex")
int_1 <- lmer(score ~ sexf * t + t2 + (1 | studyid), data = cog, REML = F)
int_1 %>%  summary()
coef_1 <- lmer(score ~ sexf * t + t2 + (1 + t | studyid), data = cog, REML = F)
coef_1 %>% summary()
anova(int_1, coef_1)
cog %>%
group_by(t) %>%
summarise(mean = mean(score),
median = median(score),
std = sd(score),
min = min(score),
max = max(score))
cog <- cog %>%
mutate(
t_2 = if_else(t == 2, 1, 0),
t_3 = if_else(t == 3, 1, 0),
t_4 = if_else(t == 4, 1, 0),
t_5 = if_else(t == 5, 1, 0),
t_6 = if_else(t == 6, 1, 0),
t_7 = if_else(t == 7, 1, 0),
t_8 = if_else(t == 8, 1, 0),
t_9 = if_else(t == 9, 1, 0),
t_10 = if_else(t == 10, 1, 0),
)
fit_pw_rc_mle1 <- lmer(score ~ sexf*(t_2 + t_3 + t_4 + t_5 + t_6 + t_7 + t_8 +t_9 + t_10) + (1 + t | studyid), data = cog, REML=F)
summary(fit_pw_rc_mle1)
anova(coef_1, fit_pw_rc_mle1)
cog$predict_coef <- predict(coef_1)
cog$predict_pw <- predict(fit_pw_rc_mle1)
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
#stat_summary(aes(group = gender), geom = "line", fun = mean) +
#stat_smooth(aes(group = gender)) +
theme_bw()
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
labs(title = "Predicted Mean Score",
color = "Model") +
scale_color_discrete(labels = c("HOM", "PW"))
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
labs(title = "Predicted Mean Score",
color = "Model") +
scale_color_discrete(labels = c("Quadratic (hom)", "Piece-wise Linear Model"))
cog %>%
pivot_longer(cols = starts_with('predict'),
names_to = "model",
values_to = "prediction") %>%
ggplot(aes(x = t, y = prediction, color = model)) +
geom_smooth() +
labs(title = "Predicted Mean Score Over Time by Model",
color = "Model",
y = "Predicted Mean Score",
x = "Time (Years)") +
scale_color_discrete(labels = c("Quadratic (hom)", "Piece-wise Linear Model"))
