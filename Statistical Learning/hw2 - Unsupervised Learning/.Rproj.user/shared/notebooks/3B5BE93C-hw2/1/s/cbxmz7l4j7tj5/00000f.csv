"0","while(TRUE) {"
"0","  means <- q2 %>% group_by(cluster) %>% summarise(mean1 = mean(x1), mean2 = mean(x2))"
"0","  "
"0","  for (i in 1:nrow(q2)) {"
"0","    row <- q2[i, c('x1', 'x2')]"
"0","    distances <- (means$mean1 - row$x1)^2 + (means$mean2 - row$x2)^2"
"0","    q2$cluster[i] <- which.min(distances)"
"0","  }"
"0","  "
"0","  new_means <- q2 %>% group_by(cluster) %>% summarise(mean1 = mean(x1), mean2 = mean(x2))"
"0","  "
"0","  if (all(means$mean1 == new_means$mean1) && all(means$mean2 == new_means$mean2)) {"
"0","    break"
"0","  }"
"0","  "
"0","}"
"0","q2"
